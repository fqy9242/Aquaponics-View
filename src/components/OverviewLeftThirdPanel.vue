<script setup>
import { onMounted, onUnmounted, ref } from 'vue'
import * as echarts from 'echarts'

// 鱼种养殖数据
const fishData = ref([
  { name: '罗非鱼养殖', value: 3200 },
  { name: '草鱼养殖', value: 2800 },
  { name: '鲈鱼养殖', value: 2400 },
  { name: '鲤鱼养殖', value: 1800 }
])

// 蔬菜种植数据
const vegetableData = ref([
  { name: '空心菜种植', value: 5800 },
  { name: '菜心种植', value: 4600 },
  { name: '油麦菜种植', value: 3800 },
  { name: '生菜种植', value: 3200 }
])

let fishChart = null
let vegChart = null

const initCharts = () => {
  // 鱼种图表
  const fishDom = document.getElementById('fish-chart')
  fishChart = echarts.init(fishDom)
  fishChart.setOption(getChartOption(
    fishData.value,
    '#00a2ff',
    '#00f7ff'
  ))

  // 蔬菜图表
  const vegDom = document.getElementById('veg-chart')
  vegChart = echarts.init(vegDom)
  vegChart.setOption(getChartOption(
    vegetableData.value,
    '#00d48e',
    '#00ff9d'
  ))
}

const getChartOption = (data, colorStart, colorEnd, title) => {
  const sortedData = [...data]
    .sort((a, b) => b.value - a.value)
    .slice(0, 3)

  return {
    title: {
      text: title,
      left: 'center',
      textStyle: {
        color: '#89d8ff',
        fontSize: 14,
        fontWeight: 'normal'
      },
      top: 8
    },
    tooltip: {
      trigger: 'axis',
      backgroundColor: 'rgba(0,0,0,0.9)',
      borderColor: 'rgba(0,180,255,0.5)',
      borderWidth: 1,
      formatter: (params) => {
        const item = Array.isArray(params) ? params[0] : params
        return `
          <div style="margin-bottom:5px;color:${colorEnd};">${item.name}</div>
          <div>规模值：<span style="color:${colorEnd};">${item.value}亩</span></div>
          <div>排名：<span style="color:${colorEnd};">第${item.dataIndex + 1}位</span></div>
        `
      }
    },
    grid: {
      left: '30%',
      right: '12%',
      bottom: '18%',
      top: '25%'
    },
    xAxis: {
      type: 'value',
      axisLabel: {
        color: '#89d8ff',
        fontSize: 10,
        formatter: (value) => `${value}亩`
      },
      splitLine: {
        lineStyle: {
          color: 'rgba(137, 216, 255, 0.15)'
        }
      }
    },
    yAxis: {
      type: 'category',
      data: sortedData.map(item => item.name),
      axisLabel: {
        color: '#c3e8ff',
        fontSize: 12,
        formatter: value => value.replace(/养殖|种植/g, '')
      },
      axisTick: { show: false },
      axisLine: { show: false }
    },
    series: [{
      type: 'bar',
      data: sortedData.map(item => item.value),
      itemStyle: {
        color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [
          { offset: 0, color: colorStart },
          { offset: 1, color: colorEnd }
        ]),
        borderRadius: [0, 6, 6, 0],
        shadowColor: colorEnd,
        shadowBlur: 10
      },
      label: {
        show: true,
        position: 'right',
        color: colorEnd,
        fontSize: 12,
        formatter: '{c}亩'
      },
      barWidth: 14
    }]
  }
}

onMounted(() => {
  initCharts()
  window.addEventListener('resize', () => {
    fishChart?.resize()
    vegChart?.resize()
  })
})

onUnmounted(() => {
  window.removeEventListener('resize', () => {
    fishChart?.resize()
    vegChart?.resize()
  })
  fishChart?.dispose()
  vegChart?.dispose()
})
</script>

<template>
  <div class="panel-box">
    <div class="chart-group">
      <div class="chart-container">
        <div class="chart-title">
          <svg t="1740920810286" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
            p-id="20775" width="30" height="30">
            <path
              d="M917.333333 544l64-217.6c2.133333-8.533333 0-19.2-8.533333-23.466667-8.533333-4.266667-17.066667-4.266667-25.6 0l-177.066667 136.533334-172.8-177.066667V170.666667c0-6.4-4.266667-12.8-8.533333-17.066667-6.4-4.266667-12.8-4.266667-19.2-2.133333l-283.733333 98.133333H213.333333c-6.4 0-12.8 2.133333-17.066666 8.533333l-149.333334 198.4c-6.4 8.533333-6.4 21.333333 2.133334 27.733334l46.933333 46.933333-46.933333 40.533333c-8.533333 8.533333-10.666667 21.333333-2.133334 29.866667l170.666667 202.666667c4.266667 4.266667 10.666667 8.533333 17.066667 8.533333h253.866666l211.2 64h6.4c6.4 0 12.8-2.133333 17.066667-8.533333 6.4-6.4 6.4-17.066667 2.133333-23.466667l-76.8-130.133333 119.466667-91.733334 179.2 160c6.4 6.4 17.066667 6.4 25.6 2.133334 8.533333-4.266667 12.8-14.933333 8.533333-23.466667l-64-217.6zM659.2 817.066667l-108.8-32 61.866667-46.933334 46.933333 78.933334z m123.733333-238.933334c-8.533333-6.4-19.2-6.4-27.733333 0l-249.6 192H245.333333l-151.466666-179.2 46.933333-40.533333c6.4-6.4 8.533333-10.666667 8.533333-17.066667 0-6.4-2.133333-12.8-6.4-14.933333L91.733333 469.333333l132.266667-174.933333h66.133333c2.133333 0 4.266667 0 6.4-2.133333L554.666667 200.533333v70.4c0 6.4 2.133333 10.666667 6.4 14.933334l192 198.4c8.533333 8.533333 19.2 8.533333 27.733333 2.133333l140.8-108.8-46.933333 160c-2.133333 4.266667-2.133333 8.533333 0 12.8l42.666666 149.333333-134.4-121.6z"
              p-id="20776" fill="#1296db"></path>
            <path
              d="M234.666667 384h42.666666v64h-42.666666zM490.666667 576h-192v42.666667h140.8l-59.733334 59.733333-72.533333-36.266667-19.2 38.4 85.333333 42.666667c4.266667 2.133333 6.4 2.133333 10.666667 2.133333 6.4 0 10.666667-2.133333 14.933333-6.4l106.666667-106.666666c6.4-6.4 8.533333-14.933333 4.266667-23.466667s-10.666667-12.8-19.2-12.8z"
              p-id="20777" fill="#1296db"></path>
          </svg>
          <span>水产养殖TOP3</span>
        </div>
        <div id="fish-chart" class="chart-item"></div>
      </div>
      <div class="divider"></div>
      <div class="chart-container">
        <div class="chart-title">
          <svg t="1740920879723" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
            p-id="22050" width="30" height="30">
            <path
              d="M554.496 165.376c-7.68-2.048-18.432 2.56-19.968 11.264-0.512 4.096-1.536 8.192-3.072 11.776-40.448-19.456-82.944-28.16-123.392 0.512-37.888 26.112-51.2 71.168-50.688 115.712-31.232 29.184-80.384 61.952-88.064 107.52-3.584 21.504 1.024 41.472 11.264 58.368-9.216 0-18.944 0-28.16 2.048-14.336 3.584-25.6 12.288-34.304 23.552-20.992 25.6-32.768 60.416-41.984 91.648-25.088 10.24-57.856 29.184-61.952 54.272-2.048 12.288 3.072 22.528 10.24 32.256 12.8 17.408 27.136 33.28 40.96 50.176 13.312 16.384 36.352-7.168 23.04-23.04l-21.504-26.112c-4.608-5.632-13.824-12.8-15.872-19.456-7.168-21.504 29.696-36.352 45.568-41.984 9.216-3.072 12.288-11.776 10.752-19.456 7.68-25.6 16.896-51.712 31.744-73.728 16.384-23.552 44.544-15.872 69.632-22.016 15.872 8.192 29.696-17.92 13.824-29.696-64.512-47.616 23.552-110.592 57.856-142.336 6.144-1.536 10.752-6.656 10.24-14.848-2.048-33.792 3.584-71.168 31.744-93.696 33.28-26.624 68.608-14.848 102.912 2.56 5.632 5.632 17.408 6.656 23.04 0 9.216-10.24 15.36-22.528 17.408-36.352 1.536-7.68-2.048-16.384-11.264-18.944z"
              fill="#73BA2D" p-id="22051"></path>
            <path
              d="M919.552 534.528C928.256 506.88 926.72 470.016 916.48 443.392c-9.216-24.576-28.672-39.936-49.664-53.248 7.68-65.536-67.584-115.2-127.488-128.512-3.584-36.352-18.944-73.728-48.64-95.232-15.872-11.776-33.28-13.312-52.224-8.192-5.632 2.048-11.264 4.096-16.896 6.656-2.56 0.512-4.608 1.024-6.144 1.536-2.048-8.704 0-29.696 0-34.816 0-1.536-0.512-3.072-1.024-4.608 0-2.56-1.024-5.12-2.56-7.68-23.552-36.352-80.384-46.08-119.808-40.96-20.48 2.56-20.992 35.328 0 32.768 26.624-3.072 73.216-1.024 90.624 23.552 0.512 24.064-6.656 70.144 27.648 68.096 26.624-1.536 45.056-27.648 69.12-1.536 18.432 19.456 27.136 45.568 27.648 71.68v1.024c-2.048 7.68 1.024 15.872 11.264 17.408 43.008 6.144 125.44 45.056 115.2 98.816-4.096 7.168-3.584 16.384 5.632 22.016 20.48 11.776 41.472 24.064 48.64 48.64 6.144 20.992 6.144 48.64-0.512 69.12-5.632 5.632-7.68 14.848 0.512 21.504 27.648 22.528 77.824 55.808 60.928 98.304-11.776 30.208-41.472 56.32-64.512 77.312-3.072 3.072-4.608 6.656-5.12 9.728-0.512 1.536-1.024 3.584-1.024 5.632-1.024 32.768 10.24 105.472-30.72 114.688-33.28 7.68-73.728 1.536-108.544 0-4.608-5.632-11.776-8.192-19.456-3.072-26.624 18.432-51.712 29.696-84.48 26.624-29.696-2.56-49.152-22.528-68.608-43.52-2.56-3.072-5.632-4.608-8.704-5.12-9.728-6.656-26.112-2.56-26.112 12.8 0 25.088-6.656 54.272-35.328 57.344-20.992 2.048-44.032-2.56-65.024-4.096-2.56 0-4.608 0-6.656 1.024-4.096 0.512-8.192 3.072-10.752 7.68-12.288 19.968-31.744 34.304-53.76 18.944-15.36-10.752-26.624-28.16-38.4-42.496-2.56-3.584-6.144-5.12-9.216-5.12-1.536-0.512-3.584-1.024-5.632-0.512-26.112 2.048-55.808 1.024-81.408-8.192 14.336-3.072 31.232-8.704 35.328-21.504 1.024-3.072 1.024-6.656 0.512-9.216 31.744 14.848 52.224 49.152 93.696 44.032 41.472-5.12 57.856-43.008 82.944-70.656 0.512-1.024 1.536-1.536 2.048-2.56 30.208-1.024 61.952 7.68 87.552-13.312 18.944-15.872 22.016-44.032 23.04-70.144 24.576 14.848 52.736 22.528 81.408 9.728 15.872-7.168 24.576-17.92 33.28-32.256 11.264-17.408 27.136-28.16 41.472-41.984 2.56 0 5.12-1.024 7.68-2.56 27.136-17.92 54.272-19.968 83.456-31.232 12.288-4.608 19.968-8.704 25.088-22.016 6.656-17.92 2.56-45.056 2.048-63.488-1.024-27.648-16.384-73.216 4.096-95.232 14.336-15.36-8.704-38.4-23.04-23.04-31.232 33.792-14.848 76.8-13.312 118.272 0.512 12.288 4.096 30.72 0.512 42.496-4.608 13.824-6.656 12.288-23.04 16.896-24.576 6.656-46.592 14.336-67.584 27.136-4.096-0.512-8.704 0.512-12.8 4.608-15.36 15.872-35.328 26.624-48.128 45.568-10.752 16.384-16.384 30.208-39.424 30.72-19.456 0.512-36.864-10.752-51.2-22.528-0.512-0.512-1.536-1.024-2.048-1.536-7.68-9.216-28.16-5.632-29.184 10.752-1.536 20.992 3.072 67.072-17.408 77.824-20.992 10.752-49.664 0.512-72.704 3.584-7.168 1.024-11.776 5.632-14.336 11.264-28.16 31.744-52.736 86.016-101.376 46.592-24.576-19.456-41.984-32.256-73.728-35.328-1.024-2.048-2.56-4.096-3.584-6.144-1.024-1.536-2.048-2.56-3.072-4.096 24.064-28.16 47.104-58.88 74.752-83.968 26.624-24.064 53.248-41.984 76.288-70.144 2.048-2.56 4.608-5.632 7.168-8.192 32.768-5.632 70.144-13.312 98.816 3.584 16.896 9.728 32.256-13.824 19.456-25.6 1.536-1.536 2.56-3.584 3.072-6.144 1.536-11.264 5.12-21.504 10.752-31.232 10.752-17.92-17.408-34.304-28.16-16.384-7.168 11.776-12.288 25.088-14.336 38.912v2.048c-18.432-4.608-37.376-4.608-56.832-2.56 38.912-41.984 80.896-81.92 121.344-122.88 14.848-14.848-8.192-37.888-23.04-23.04-48.64 49.152-99.328 96.256-144.384 148.48-3.072-12.8-5.632-26.112 2.56-34.816 9.728-10.24 29.184-9.728 37.888-22.528 13.824-20.992 3.072-68.608 2.56-92.672-0.512-20.992-32.768-20.992-32.768 0 0.512 17.408 6.656 47.616 1.536 64-6.144 18.432-26.112 18.944-37.888 31.232-19.456 20.48-6.144 54.272-1.024 77.824 0.512 2.048 1.024 4.096 2.048 5.632-19.456 20.992-40.96 36.864-62.464 55.808-29.184 25.6-53.76 57.344-78.848 87.04-6.656-5.12-14.336-9.216-23.04-11.776-10.752-3.072-25.088-4.096-36.864-0.512-3.072-8.704-7.168-16.896-11.264-25.088-1.024-2.048-2.56-3.584-3.584-4.608-3.584-19.968-9.728-37.376-27.648-49.152-11.264-7.168-25.6-8.704-36.352-16.384-22.528-15.36-13.824-39.424-2.048-58.368 3.072-1.536 5.632-4.608 6.656-8.704 4.096-11.264 8.192-22.016 9.728-33.792 2.048-14.336-1.024-28.672 2.048-43.008 6.144-30.208 31.744-45.568 59.904-51.2 5.12-1.024 8.192-3.584 10.24-6.656 6.144-7.168 7.168-18.944-3.072-25.6-14.336-9.216-31.232-24.064-34.816-41.984-3.072-14.336 6.144-30.208 11.264-43.008 8.704-22.016 19.456-43.008 18.432-67.584 0-1.024 0-1.536-0.512-2.56 7.68-33.792 6.656-68.096 9.728-102.912 2.048-23.552 3.072-43.52 29.184-48.64 22.528-4.096 50.176-1.024 72.704-0.512 1.536 0 2.56 0 4.096-0.512 5.12 0 9.728-2.048 12.8-8.192 20.992-45.056 54.784-79.872 107.008-55.296 18.944 8.704 35.328-19.456 16.384-28.16-29.184-13.312-57.344-19.968-88.064-5.12-27.648 13.312-46.08 37.888-59.904 65.024-35.84-2.048-95.744-10.752-114.688 24.576-23.552 45.056-9.728 105.984-21.504 154.112-0.512 2.56-0.512 5.12 0 7.168v1.024c1.024 37.888-32.768 69.632-30.208 107.52 1.536 20.48 12.288 38.912 27.136 53.76-18.944 7.68-35.84 20.48-47.104 38.912-18.432 30.208-11.264 65.536-20.992 98.816-1.536 1.024-3.072 2.56-4.096 4.608-16.384 25.088-26.112 56.32-9.728 83.968 8.192 13.312 18.944 19.456 32.768 25.6 25.6 10.752 34.816 17.92 38.912 45.568 1.024 5.632 4.096 9.216 7.68 10.752 4.608 8.704 8.192 17.92 11.264 27.136 1.536 5.632 5.632 9.216 10.24 10.752 0.512 1.024 1.536 1.536 2.56 2.56 0 1.536 0.512 2.56 1.024 4.096 10.752 30.72 18.432 75.264 47.616 94.72 32.768 22.016 77.824 26.624 116.736 24.064 18.432 23.04 38.912 51.2 70.144 54.784 27.136 3.072 49.152-12.8 64.512-33.792 29.184 2.56 69.632 11.776 94.208-5.12 15.872-10.752 25.088-29.184 29.696-48.128 18.432 17.408 38.912 31.232 65.536 34.816 38.4 5.12 69.632-5.12 100.864-24.576 2.048 0.512 3.584 1.024 6.144 1.536 44.032 1.024 112.64 15.872 150.528-13.312 35.84-27.136 26.624-89.088 27.136-129.536 30.208-28.16 71.168-68.096 75.776-110.592 3.584-43.008-36.352-75.776-67.584-101.376zM209.92 813.568c4.608 7.168 9.216 14.336 13.312 21.504-1.536 0.512-3.072 0.512-4.096 1.024-5.632 1.536-11.776 2.56-17.92 3.584-4.096 0.512-7.168 3.072-9.216 6.656-3.072-4.608-5.632-9.216-7.68-14.336 8.704-6.144 16.896-12.288 25.6-18.432z m-20.992-24.576c-5.12 3.584-10.24 7.168-14.848 10.752-2.048-6.144-3.584-12.288-5.632-17.408 5.632 0.512 12.8 2.56 14.848 3.072 1.536 1.024 3.584 2.048 5.632 3.584z"
              fill="#73BA2D" p-id="22052"></path>
            <path
              d="M665.088 828.928c10.24-40.448-37.888-80.384-76.288-72.192-20.48 4.096-11.776 35.84 8.704 31.232 13.824-3.072 39.936 16.896 36.352 32.256-5.12 20.48 26.624 29.184 31.232 8.704zM765.44 676.352c-28.16-17.408-50.688 13.824-76.288 23.04-19.456 7.168-11.264 38.4 8.704 31.232 12.288-4.608 24.064-9.216 34.816-16.896 13.824-9.216 17.92-9.216 30.208 3.072 17.408 17.408 32.768 35.84 55.296 46.592 18.944 9.216 35.328-18.944 16.384-28.16-28.16-13.312-43.008-42.496-69.12-58.88zM629.76 339.456c18.944-9.216 2.56-37.376-16.384-28.16-20.48 9.728-48.128 20.992-56.32 44.544-4.608 13.312-1.536 26.624-1.024 40.448 1.024 16.384-4.096 31.232-5.632 47.104-1.536 15.872 2.56 40.96 23.04 41.984 10.24 0.512 21.504-6.656 32.256-15.36v43.52c0.512 13.312 2.048 26.112 12.288 35.328 10.24 8.704 23.04 9.728 36.352 9.728 18.944 0.512 37.888 0.512 57.344 1.024 20.992 0.512 20.992-32.256 0-32.768-11.264 0-22.528-0.512-33.792-0.512-9.216 0-27.136 3.072-35.328-1.536-7.168-4.608-4.096-18.944-4.096-27.136v-35.84c0-7.168-4.096-12.288-9.216-14.336 3.584-4.096 6.656-7.68 8.704-10.24 13.312-15.872-9.728-38.912-23.04-23.04-9.216 11.264-20.992 19.456-31.232 28.672 0.512-3.584 1.536-7.168 2.048-10.752 1.024-5.632 2.048-11.776 2.56-17.408 1.536-14.336-5.12-33.28 0-46.592 5.12-14.336 28.672-22.528 41.472-28.672zM443.904 368.128c16.896-11.264 35.328-17.92 55.808-18.432 20.992-0.512 20.992-33.28 0-32.768-2.048 0-4.096 0-6.144 0.512-0.512-18.432 2.56-35.84 8.704-53.248 7.168-19.456-24.064-28.16-31.232-8.704-8.192 22.016-11.264 44.544-10.24 68.096-11.776 3.584-23.04 9.216-33.792 16.384-16.896 11.776-0.512 39.936 16.896 28.16zM304.64 311.296c14.336-4.096 16.896-16.896 20.48-29.696 4.608-17.408 7.168-46.592 20.48-59.392 14.848-14.848-8.192-37.376-23.04-23.04-10.752 10.24-14.848 22.528-18.432 36.864-3.072 11.776-5.12 30.208-10.752 43.008-9.728-3.584-23.552-19.456-29.184-24.064-10.24-8.192-20.992-14.848-33.28-19.968-19.456-7.68-27.648 23.552-8.704 31.232 25.6 10.752 51.2 53.76 82.432 45.056zM184.32 403.968c18.944 10.24 33.792 24.576 44.032 43.008 10.24 18.432 38.4 2.048 28.16-16.384-13.312-23.04-32.256-42.496-55.808-54.784-18.432-10.24-34.816 17.92-16.384 28.16z"
              fill="#73BA2D" p-id="22053"></path>
          </svg>
          <span>蔬菜种植TOP3</span>
        </div>
        <div id="veg-chart" class="chart-item"></div>
      </div>
    </div>
  </div>
</template>

<style scoped>
.panel-box {
  height: 260px;
  position: relative;
  background: rgba(9, 44, 88, 0.7);
  border: 1px solid rgba(0, 180, 255, 0.2);
  border-radius: 8px;
  padding: 15px;
}

.chart-group {
  display: flex;
  height: 100%;
  gap: 10px;
}

.chart-container {
  flex: 1;
  position: relative;
}

.chart-title {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  text-align: center;
  color: #00f7ff;
  font-size: 14px;
  letter-spacing: 1px;
  padding: 4px 0;
  background: linear-gradient(90deg, transparent, rgba(0, 180, 255, 0.1), transparent);
}

.chart-item {
  width: 100%;
  height: 100%;
}

.divider {
  width: 1px;
  background: linear-gradient(transparent 10%, rgba(0, 180, 255, 0.3) 50%, transparent 90%);
  margin: 24px 5px 0;
}

/* 优化悬停效果 */
.chart-item canvas {
  transition: filter 0.3s;
  filter: drop-shadow(0 0 3px rgba(0, 180, 255, 0.2));
}

.chart-item:hover canvas {
  filter: drop-shadow(0 0 8px rgba(0, 180, 255, 0.4));
}
</style>