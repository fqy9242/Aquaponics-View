<script setup>
import * as echarts from 'echarts';
import { ref, onMounted, onUnmounted } from 'vue';
import $ from 'jquery';
import { getBaseInfoApi } from '@/apis/overView'

// 定义DOM引用和图表实例
const chartDom = ref(null);
let myChart = null;

// 城市坐标映射（保留原结构）
const geoCoordMap = {
    '南宁市': [108.320004, 22.82402],
    '百色市': [106.616285, 23.897742],
    '河池市': [108.062105, 24.695899],
    '柳州市': [109.411703, 24.314617],
    '桂林市': [110.299121, 25.274215],
    '崇左市': [107.353926, 22.404108],
    '来宾市': [109.229772, 23.733766],
    '贵港市': [109.602146, 23.0936],
    '贺州市': [111.552056, 24.414141],
    '梧州市': [111.297604, 23.474803],
    '防城港市': [108.000478, 21.914631],
    '钦州市': [108.624175, 21.967127],
    '北海市': [109.339254, 21.653343],
    '玉林市': [110.154393, 22.63136],
}

// 响应式数据
const customerBatteryCityData = ref([]);
const mapData = ref([]);
const dataMap = ref({});

// 获取后端数据
const getBaseInfo = async () => {
    try {
        const res = await getBaseInfoApi();

        customerBatteryCityData.value = res.data.map(item => ({
            name: item.city,
            value: item.cnt
        }));

        mapData.value = res.data.map(item => ({
            name: item.city.replace(/市$/, ''),
            value: item.cnt
        }));

        // 生成数据映射
        dataMap.value = mapData.value.reduce((map, item) => {
            map[item.name] = item.value;
            return map;
        }, {});

    } catch (error) {
        console.error('数据获取失败:', error);
    }
};

// 生成图表数据
const generateChartData = () => {
    const maxValue = Math.max(...customerBatteryCityData.value.map(item => item.value));
    const lineMaxHeight = 0.9 / maxValue;

    const lineData = customerBatteryCityData.value.map(item => ({
        coords: [
            geoCoordMap[item.name],
            [geoCoordMap[item.name][0], geoCoordMap[item.name][1] + item.value * lineMaxHeight]
        ]
    }));

    const scatterData = customerBatteryCityData.value.map(item => [
        geoCoordMap[item.name][0],
        geoCoordMap[item.name][1] + item.value * lineMaxHeight,
        item.value
    ]);

    const scatterData2 = customerBatteryCityData.value.map(item => ({
        name: item.name,
        value: geoCoordMap[item.name]
    }));

    return { lineData, scatterData, scatterData2 };
};

// 初始化图表
const initChart = async () => {
    if (!chartDom.value) return;

    try {
        // 加载地图数据
        const geoJson = await $.getJSON("src/assets/json/450000.json");
        echarts.registerMap('guangxi', geoJson);

        // 等待数据加载
        await getBaseInfo();

        // 生成动态数据
        const { lineData, scatterData, scatterData2 } = generateChartData();

        // 完整配置项
        const option = {
            tooltip: {
                trigger: 'item',
                show: true,
                enterable: true,
                textStyle: {
                    fontSize: 20,
                    color: '#fff'
                },
                backgroundColor: 'rgba(0,2,89,0.8)',
                formatter: function (params) {
                    if (params.seriesType === 'scatter' && params.value.length > 2) {
                        return `${params.name} : ${params.value[2]}`;
                    } else if (params.seriesType === 'map' && dataMap.value[params.name] !== undefined) {
                        return `${params.name} : ${dataMap.value[params.name]}`;
                    } else {
                        return `${params.name} : 0`;
                    }
                }
            },
            geo: [{
                map: 'guangxi',
                aspectScale: 0.9,
                roam: false,  // 是否允许拖动和缩放
                zoom: 1.2,  // 地图缩放
                layoutSize: '95%',
                layoutCenter: ['55%', '50%'],
                itemStyle: {
                    normal: {
                        areaColor: {
                            type: 'linear-gradient',
                            x: 0,
                            y: 300,
                            x2: 0,
                            y2: 0,
                            colorStops: [{
                                offset: 0,
                                color: 'rgba(50, 200, 50, 0.3)'
                            }, {
                                offset: 1,
                                color: 'rgba(152, 251, 152, 0.3)'
                            }],
                            global: true
                        },
                        borderColor: '#FFFACD',
                        borderWidth: 1,
                        shadowBlur: 10, // 添加阴影模糊
                        shadowColor: 'rgba(255, 255, 255, 0.8)' // 阴影颜色
                    },
                    emphasis: {
                        areaColor: '#C0FF3E'
                    },
                },
                emphasis: {
                    itemStyle: {
                        areaColor: '#0160AD',
                    },
                    label: {
                        show: 0,
                        color: '#fff'
                    }
                },
                zlevel: 3
            }],
            series: [
                // 地图系列
                {
                    geoIndex: 0,
                    type: 'map',
                    roam: true,
                    // zoom: 2.2,
                    label: {
                        normal: {
                            show: false,
                            textStyle: { color: '#fff' }
                        },
                        emphasis: { show: false }
                    },
                    itemStyle: {
                        normal: {
                            borderColor: '#2ab8ff',
                            borderWidth: 1.5,
                            areaColor: '#12235c'
                        },
                        emphasis: {
                            areaColor: '#2AB8FF',
                            borderWidth: 0
                        }
                    },
                    map: 'guangxi',
                    data: customerBatteryCityData.value
                },
                // 柱状体主干
                {
                    type: 'lines',
                    zlevel: 5,
                    effect: {
                        show: false,
                        symbolSize: 5
                    },
                    lineStyle: {
                        width: 20,
                        color: 'rgba(22,255,255,0.6)',
                        opacity: 1,
                        curveness: 0
                    },
                    silent: true,
                    data: lineData
                },
                // 柱状体顶部
                {
                    type: 'scatter',
                    coordinateSystem: 'geo',
                    geoIndex: 0,
                    zlevel: 5,
                    label: {
                        show: true,
                        formatter: params => params.value[2],
                        position: "top"
                    },
                    symbol: 'circle',
                    symbolSize: [20, 10],
                    itemStyle: {
                        color: 'rgba(22,255,255,1)',
                        opacity: 1
                    },
                    silent: true,
                    data: scatterData
                },
                // 柱状体底部
                {
                    type: 'scatter',
                    coordinateSystem: 'geo',
                    geoIndex: 0,
                    zlevel: 4,
                    label: {
                        formatter: '{b}',
                        position: 'bottom',
                        color: '#fff',
                        fontSize: 15,
                        distance: 10,
                        show: true
                    },
                    symbol: 'circle',
                    symbolSize: [20, 10],
                    itemStyle: {
                        color: 'rgba(22,255,255,1)',
                        opacity: 1
                    },
                    silent: true,
                    data: scatterData2
                },
                // 底部外框
                {
                    type: 'scatter',
                    coordinateSystem: 'geo',
                    geoIndex: 0,
                    zlevel: 4,
                    symbol: 'circle',
                    symbolSize: [40, 20],
                    itemStyle: {
                        color: {
                            type: 'radial',
                            x: 0.5,
                            y: 0.5,
                            r: 0.5,
                            colorStops: [
                                { offset: 0, color: 'rgba(22,255,255,0)' },
                                { offset: 0.75, color: 'rgba(22,255,255,0)' },
                                { offset: 0.751, color: 'rgba(22,255,255,1)' },
                                { offset: 1, color: 'rgba(22,255,255,1)' }
                            ]
                        },
                        opacity: 1
                    },
                    silent: true,
                    data: scatterData2
                }
            ]
        };

        // 销毁旧实例
        if (myChart) myChart.dispose();

        // 初始化新图表
        myChart = echarts.init(chartDom.value);
        myChart.setOption(option);

    } catch (error) {
        console.error('图表初始化失败:', error);
    }
};

// 生命周期管理
onMounted(async () => {
    await initChart();
    window.addEventListener('resize', () => myChart?.resize());
});

onUnmounted(() => {
    window.removeEventListener('resize', () => myChart?.resize());
    myChart?.dispose();
});
</script>

<template>
    <div class="panel-box water-quality-panel">
        <div class="panel-title">
            <svg t="1740459964505" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="30" width="30" height="30">
                <path
                    d="M589.047957 214.815025c1.451453-0.241909 6.531538 2.902906 7.257264 3.144814 40.64068 12.337349 54.429483 9.676352 104.020789 38.947319 46.446492 27.577605 69.669738 48.86558 101.359792 88.538625 68.218285 85.151902 88.780534 205.864399 56.122844 312.062367-20.078431 65.07347-55.155209 112.487597-104.020789 157.482637-8.466808 7.741082-24.190881 14.756438-24.190881 28.787148 0 13.304985 17.175526 42.575951 44.511221 19.594614l43.543587-40.64068c14.756438-14.514529 38.70541-47.172218 49.591306-65.557288 104.262698-174.900071 59.751476-389.231278-96.763525-514.298134-46.204583-37.012048-134.501299-77.41082-193.28514-77.41082 7.499173-10.885897 18.626979-14.514529 18.626978-31.206236 0-14.998346-9.676352-24.916608-24.916607-24.916608-17.659343 0-68.460194 51.284668-68.460194 74.749823 0 23.707064 13.304985 33.625325 25.884243 45.962674 10.16017 10.16017 25.400425 31.931963 42.575951 31.931963 24.916608 0 34.109142-29.996693 15.724072-43.543586l2.419089-3.628632zM138.613749 529.538389c0 78.136546 1.209544 119.261044 35.076778 191.833688 18.143161 38.70541 43.059768 74.749823 71.363099 103.053153 60.235294 59.751476 139.581384 111.519962 229.571463 119.019136-8.950626 16.691708-15.965982 17.417434-17.659344 29.029057-1.209544 8.708717 7.015356 26.851878 23.707064 26.851878 20.804158 0 74.749823-63.380109 74.749823-74.749823 0-25.158516-76.685093-114.422868-97.005434-62.170564-4.596267 11.853532 0.483818 18.626979 6.773447 28.061422-49.833215-4.11245-115.148594-40.64068-152.886369-71.121191-65.315379-52.736121-124.09922-151.193007-124.09922-249.407985 0-83.942358 12.821167-139.339476 54.671391-203.44531 18.143161-27.335696 31.448146-39.673045 53.461847-61.686747 8.2249-8.2249 22.497519-18.868887 26.60997-29.996693 5.321994-14.756438-8.466808-31.448146-22.739429-31.448145-33.141507 0-93.61871 86.361446-110.068509 113.697141-24.916608 41.124498-51.526577 108.375148-51.526577 172.480983z"
                    p-id="7981" fill="#1afa29"></path>
                <path
                    d="M348.348689 364.31467c14.756438-0.725726 30.964328 16.20789 40.398771 26.126152 11.369714 11.611623 19.836523 24.43279 28.061423 39.914954 1.93527 3.870541 9.918261 20.32034 8.950626 24.43279-2.660997 10.16017-34.834869 38.221592-62.170565 39.914954-27.577605 1.451453-40.156863 1.209544-64.831562-15.482164-2.902906-1.93527-15.724073-13.063076-16.933616-16.20789-1.451453-3.870541 4.596267-21.046067 6.04772-25.400426 8.466808-22.013702 27.577605-54.9133 47.656036-68.702102 2.902906-1.93527 8.708717-4.354359 12.821167-4.596268z m83.700449 112.971416c1.451453 25.642334 4.11245 43.059768-3.870541 70.637373-18.38507 62.170565-54.187574 67.976376-37.737775 93.860618 6.773447 10.643988 17.901252 7.982991 32.899599 28.303331 11.127805 14.998346 19.836523 47.414127 6.289629 43.059769-2.419088-0.725726-45.962674-40.882589-101.117884-9.192535-10.16017 5.805811-19.110796 15.240255-21.287975 16.20789-14.514529 6.289629-9.192535-41.850224 18.38507-63.380108 6.04772-4.596267 16.449799-10.643988 15.240255-23.948973-1.451453-19.110796-31.206237-28.54524-49.591307-74.749822-11.853532-29.270966-11.369714-40.156863-13.304984-72.088826 5.321994 3.144815 9.918261 7.499173 15.482164 11.127805 41.366407 27.335696 93.61871 21.287975 131.114576-12.821167 2.419088-2.419088 5.321994-5.321994 7.499173-7.015355z m-83.700449-130.872668c-21.529884 1.209544-35.076778 16.933617-47.172218 32.173872-9.918261 12.579258-9.676352 12.095441-18.868888 27.577605-33.141507 56.848571-28.54524 132.807938 7.499173 187.963147l15.240256 19.836522c7.982991 9.434444 16.933617 13.546893 17.175525 20.804158 0.241909 3.870541-8.466808 7.982991-15.482164 14.756437-5.080085 4.596267-9.918261 11.611623-13.546893 17.659344-7.015356 12.095441-13.304985 29.754784-12.33735 48.381762 1.209544 17.417434 21.529884 32.173872 40.398772 16.933617 2.177179-1.93527 2.902906-3.144815 5.080085-5.080085 20.562249-18.626979 52.97803-22.255611 77.652729-9.434444 8.466808 4.596267 17.659343 14.27262 26.851878 13.788802 13.546893-0.725726 25.158516-12.095441 24.43279-24.916607-0.967635-18.626979-9.192535-36.528231-17.175526-47.172218s-13.788802-15.724073-24.43279-22.49752c-11.369714-7.257264-12.579258-6.04772 0.241909-22.497519 3.628632-4.596267 6.773447-8.2249 9.918261-13.304985 2.902906-5.321994 5.321994-9.192535 8.2249-14.998346 27.577605-52.010395 26.36806-114.664777-0.967636-167.400898-14.030711-26.851878-52.252303-74.266005-82.732813-72.572644z"
                    p-id="7982" fill="#1afa29"></path>
                <path
                    d="M351.735412 423.582329c-22.255611 1.209544-14.756438 27.819513 0.483818 26.851878 6.531538-0.241909 12.821167-8.2249 12.579258-15.240255-0.241909-4.838176-7.257264-11.853532-13.063076-11.611623zM593.644224 754.513584c-33.383416 16.933617-30.48051 18.626979-41.366407-2.902906-15.965982-31.448146 10.643988-71.121191 25.642334-97.973069l41.608316-77.168911c1.693362-3.628632 3.628632-8.950626 6.289629-11.369714 16.20789 32.173872 5.563903 61.202929 3.628632 101.117883-2.177179 42.334042 4.838176 67.734467-35.802504 88.296717z m120.228679-262.954879c4.838176-2.419088 4.838176-19.110796 12.821167-31.690054 7.982991-11.853532 22.013702-14.998346 35.802505-17.175526 27.819513-4.11245 45.236948 3.628632 60.96102 34.834869 8.2249 16.449799 11.853532 30.722419 9.434444 43.785495-4.838176 28.787149-30.722419 41.850224-58.300024 42.092133-4.838176 0-7.982991-0.483818-12.337349-0.725726-17.417434-1.451453-14.998346 0-18.38507 9.434444-3.386723 8.708717-14.030711 19.594614-22.013702 24.43279-11.611623 7.015356-32.173872 17.901252-40.882589 0.725726-0.967635-1.93527 1.93527-19.594614 2.660997-22.255611 6.773447-23.465155 40.882589-38.70541 65.557288-51.042759l27.819513-14.27262c6.773447-3.386723 5.321994 0.241909 10.643988-6.531538-3.144815-11.853532-4.354359-14.27262-30.722419-0.725726-22.981337 11.611623-50.317033 23.948972-69.427829 40.398771-12.095441 10.402079-13.788802 14.756438-18.38507 28.061423-9.918261 30.48051-1.451453 69.427829-1.209544 102.085518 0.241909 16.449799-6.531538 49.349398-14.514529 63.622018-8.708717 15.724073-20.804158 26.126152-39.673045 30.722419-5.563903 1.451453-8.2249 0.967635-12.337349 2.177179 0.483818-4.11245-0.241909-2.419088 4.838176-5.080085 3.144815-1.693362 4.596267-2.177179 7.499173-4.354359 4.838176-3.386723 8.466808-6.289629 12.095441-10.16017 13.304985-13.788802 16.20789-30.964328 17.175526-49.349397 0.483818-9.434444 0.725726-18.143161 1.451452-27.819514 1.451453-17.659343 6.773447-67.976376 5.563903-81.28136-3.386723-39.431136-24.43279-37.012048-17.659343-60.719112 3.386723-11.853532 9.918261-15.240255 19.352705-23.707064 12.337349-10.885897 0.725726-1.93527 14.27262-8.708717 27.577605-13.546893 40.64068-3.144815 47.897944-6.773447z m-63.622017-14.030711c-9.918261-19.836523-21.046067-28.061422-21.771793-40.64068-0.483818-7.741082-6.289629-19.594614-10.16017-27.335696l8.950626-18.868887c13.304985-19.594614 39.431136-26.126152 60.719112-20.32034 29.754784 7.741082 39.189227 30.964328 39.673045 59.02575 0 5.080085 1.209544 6.531538-2.660997 10.16017-3.386723 3.144815-5.563903 4.354359-8.2249 7.982991-2.177179 2.419088-4.11245 6.289629-5.563903 8.950626-2.177179 4.354359-5.805811 14.998346-6.289629 19.594613-19.836523-0.241909-18.143161-0.725726-37.979683 4.354359 0.483818-4.11245 1.93527-7.257264 3.144814-11.611623 1.693362-4.838176 9.434444-32.65769 7.982991-35.560595-2.902906-5.805811-6.773447-5.321994-11.611623-2.902906-4.354359 2.177179-12.095441 39.914954-16.20789 47.172218z m-194.252776-14.514528c9.434444 18.38507 23.707064 29.270966 40.64068 36.044413 5.080085 2.177179 12.095441 2.177179 16.207891 4.112449-6.531538 5.805811-4.11245 28.787149 0.241909 37.495866l5.080085 9.918261c6.289629 12.579258 23.223246 24.190881 34.59296 21.529885 2.177179-3.144815 4.354359-6.531538 1.693361-10.885897-2.660997-4.11245-19.836523-4.596267-26.36806-23.948972-3.386723-10.16017-5.321994-15.965982-3.144815-24.190881 2.419088-9.434444 11.853532-14.756438 8.2249-21.529885-2.177179-4.596267-12.337349-3.144815-17.175526-3.386723-36.286322-1.209544-55.880936-39.914954-53.703756-67.25065 0.967635-10.16017 5.080085-18.38507 11.853532-26.851878 26.36806-33.625325 93.134893-46.204583 115.632412-6.531538 7.257264 12.821167 23.223246 40.398772 22.739428 52.494213-0.241909 6.531538-3.628632 6.531538-3.870541 14.514528 3.386723 4.354359 6.773447 5.321994 12.095441 4.11245 5.563903 10.885897 13.063076 20.804158 19.594614 33.867234 3.870541 7.741082-27.093787 13.788802-24.916608 50.80085 0.241909 5.563903 0.725726 3.870541-1.693362 8.708717-10.643988 21.771793-18.143161 37.253957-29.996692 58.541933-11.369714 20.078431-32.173872 57.574297-41.124498 79.587999-3.870541 9.918261-8.950626 21.046067-9.918262 31.690054-0.483818 3.628632 0.241909 5.805811-2.660997 8.466809-22.981337-45.478857-18.626979-57.816206 2.660997-95.79589 17.417434-30.964328 47.172218-58.541932 58.300024-78.378455 19.594614-35.318687-7.499173-86.845263-27.577605-126.2764-1.209544-2.419088-0.967635-0.967635-2.902905-3.628632-15.965982 4.11245-11.369714 7.257264-0.725727 33.141507 7.257264 17.901252 17.417434 36.770139 21.771793 55.397118 7.015356 31.931963-8.950626 44.511221-29.270966 67.008741-9.192535 10.402079-14.998346 20.078431-22.255611 30.964328-3.870541 5.563903-7.015356 10.643988-9.918261 15.965982-3.144815 5.321994-6.04772 10.402079-8.950626 16.20789-18.38507 37.253957-13.546893 55.639027 3.870541 90.473896 6.531538 12.821167 33.141507 49.833215 50.075124 47.897944 28.54524-3.386723 41.124498 6.289629 69.18592-7.98299 16.20789-8.2249 25.400425-20.804158 31.448146-32.173872 5.805811-10.885897 10.402079-27.093787 12.579258-39.189228 2.660997-15.240255 4.596267-25.642334 3.628632-42.092133l-1.451453-45.478857c6.289629 6.773447 27.093787 3.870541 35.076778-0.241909 12.095441-6.04772 20.804158-10.16017 29.996693-21.046066 15.724073-18.626979 4.11245-19.110796 24.190881-17.417435 35.318687 2.660997 67.976376-16.449799 77.41082-51.768485 1.93527-7.741082 2.177179-17.417434 0.241908-26.368061-0.725726-3.870541-2.419088-10.643988-4.112449-14.756437-1.93527-5.080085-4.11245-11.127805-6.289629-15.482164-2.902906-5.805811-13.546893-21.529884-18.143161-26.126152-7.499173-7.257264-13.304985-10.402079-22.255611-13.304985-14.998346-4.838176-23.707064-4.596267-39.189228-2.177179-4.596267 0.725726-10.643988 2.660997-14.272619 2.660997-0.967635-3.628632-0.483818-5.321994-0.725727-8.466808-3.386723-31.931963-17.901252-58.541932-51.284668-66.283015-7.015356-1.693362-16.933617-2.902906-24.43279-2.177179-28.303331 2.660997-43.543586 12.821167-56.848571 36.52823-5.805811-11.127805-13.546893-21.046067-21.287975-26.851878-16.933617-12.821167-35.318687-17.175526-56.606662-14.998346-23.948972 2.660997-50.317033 14.514529-66.524923 32.899598-20.32034 23.465155-23.948972 53.219939-9.434444 82.007088z"
                    p-id="7983" fill="#1afa29"></path>
            </svg>
            <span class="title-text">鱼菜共生运营基地</span>
        </div>
        <!-- 地图顶部信息 -->
        <div class="base-info">
            <div class="info-item">
                <svg t="1740534428509" class="info-item-ico" viewBox="0 0 1024 1024" version="1.1"
                    xmlns="http://www.w3.org/2000/svg" p-id="2161" width="50" height="50">
                    <path
                        d="M661.665 659.841c-30.719 0-56.32-25.601-56.32-56.319 0-30.724 25.603-56.319 56.32-56.319 30.723 0 56.32 25.597 56.32 56.319 0 32.425-25.597 56.319-56.32 56.319z m0-172.375c-73.387 0-133.117 59.735-133.117 133.122 0 23.891 6.824 47.785 18.773 66.559l11.944 25.603 25.603 51.199 76.797 157.012L767.48 707.628l10.238-18.774c5.121-10.236 10.238-20.479 13.652-32.426 3.414-10.242 5.121-22.187 5.121-34.132-1.705-75.095-61.439-134.83-134.826-134.83z"
                        fill="#1afa29" p-id="2162"></path>
                    <path
                        d="M898.893 144.427l-167.251-39.254c-6.827-1.707-11.948 0-18.772 1.707l-194.563 91.359v57.951c3.555-0.117 7.081-0.956 10.242-2.537l199.68-90.453 136.53 30.719v476.16l-27.305-6.828-13.652 27.308c-1.707 5.121-5.12 10.238-6.828 13.653v1.707l-5.12 11.945 73.387 17.068c8.535 1.703 17.066 0 23.895-5.12 6.824-5.12 10.238-13.651 10.238-22.188l1.707-535.895c-0.002-11.942-8.533-23.888-22.188-27.302zM101.88 758.826c0 8.535 5.121 18.771 11.945 23.894 6.828 5.121 17.067 6.828 25.602 3.414l184.32-73.386 182.613 75.093c3.415 1.707 6.829 1.707 10.238 1.707 3.414 0 8.535-1.707 11.949-3.414l15.359-6.828-25.603-51.198-1.707 1.707-180.904-75.095c-3.414-1.707-6.824-1.707-10.238-1.707s-6.828 0-10.242 1.707L158.2 717.865V354.853h-56.32v403.973z"
                        fill="#1afa29" p-id="2163"></path>
                    <path
                        d="M106.255 125.201l2.977-0.701-1.836-2.446c-3.367-4.485-5.929-9.321-7.612-14.373l-0.729-2.188-2.063 1.031c-4.601 2.301-10.707 4.625-18.151 6.909-7.451 2.296-16.456 3.745-26.767 4.309l-2.039 0.111 0.154 2.037c0.579 7.651 0.873 15.289 0.873 22.7v84.174c-1.128 5.488-3.072 10.191-5.779 13.979l-1.173 1.642 1.65 1.158c5.634 3.954 9.601 7.621 11.791 10.9l1.265 1.893 1.715-1.498c4.592-4.014 9.21-7.334 13.728-9.87 3.888-2.189 8.336-4.655 13.259-7.351-1.452 10.016-4.609 19.547-9.405 28.383-5.426 9.982-13.711 20.005-24.627 29.788l-2.4 2.151 2.994 1.195c5.521 2.203 10.59 5.87 15.068 10.898l1.593 1.789 1.476-1.887c10.588-13.538 18.358-25.648 23.096-35.997 4.739-10.368 8.042-20.733 9.818-30.806 1.767-10.008 2.516-26.692 2.228-49.593-0.299-22.647 0.139-38.517 1.301-47.168l0.272-2.031-2.037-0.224c-5.209-0.569-10.768-1.447-16.521-2.608L87.852 141l0.126 2.567c0.615 12.484 0.877 18.501 0.877 20.116v23.473c-2.427-14.15-4.343-24.522-5.712-30.922l-0.485-2.268-2.172 0.813c-3.701 1.386-7.216 2.4-10.482 3.028V132c14.397-2.237 26.588-4.523 36.251-6.799z m-17.401 93.525c-7.825 4.093-14.147 6.869-18.852 8.282v-46.407c1.876 9.472 3.189 17.704 3.921 24.603l0.251 2.365 2.287-0.653c3.811-1.087 7.976-2.463 12.393-4.094v15.904zM236.449 128.37l-1.987-0.598-0.523 2.009c-3.229 12.385-7.781 24.69-13.545 36.617l-0.171-0.614A279.233 279.233 0 0 0 209.6 134.8l-0.71-1.729-17.091 5.697 0.956 2.036c4.603 9.799 8.104 20.009 10.405 30.346l0.604 2.71 2.379-1.43c2.691-1.618 6.913-3.014 12.548-4.148l0.869-0.175c-0.139 0.279-0.276 0.557-0.416 0.835l-1.281 2.563 2.848 0.319c4.939 0.553 9.686 2.229 14.106 4.983l2.066 1.287 0.862-2.277c10.041-26.542 14.853-34.818 17.121-37.087l1.964-1.964-2.485-1.239c-5.955-2.97-11.976-5.379-17.896-7.157z"
                        fill="#1afa29" p-id="2164"></path>
                    <path
                        d="M232.358 225.844h-12.063v-8.595c6.839-6.774 15.146-13.909 24.703-21.215l0.785-0.601V180.14h-45.066c-6.313 0-14.065-0.236-23.086-0.704l2.361-1.885c2.716-2.168 7.204-4.115 13.34-5.786l2.237-0.609-0.931-2.123a556.526 556.526 0 0 1-11.385-28.024l-0.825-2.2-2.041 1.166c-3.961 2.266-8.571 4.281-13.702 5.991l-1.662 0.555c0.133-4.492 0.395-11.435 0.777-20.546l0.05-1.172c2.308 3.831 3.925 7.328 4.819 10.432l0.504 1.746 1.787-0.335c8.817-1.654 19.88-3.666 33.817-6.148 13.05-2.311 27.591-5.19 44.455-8.803l3.292-0.705-2.194-2.554c-3.397-3.955-6.559-8.844-9.395-14.531l-0.866-1.735-1.762 0.813c-7.458 3.439-18.545 6.644-32.954 9.522-14.47 2.902-28.589 4.962-41.967 6.121l-3.365 0.292 1.874 2.81a85.38 85.38 0 0 1 1.396 2.164h-55.472l0.131 2.123c0.581 9.438 0.875 18.563 0.875 27.123v124.805c0 6.876-0.287 16.332-0.877 28.91l-0.098 2.094h20.015l-0.101-2.096c-0.582-12.114-0.877-21.84-0.877-28.908v-30.715c2.061 6.452 3.378 12.7 3.919 18.593l0.184 2.008 2.006-0.2c12.195-1.215 19.998-3.211 23.854-6.104 4.087-3.064 6.073-10.344 6.073-22.254V151.38c0-0.785 0.021-1.979 0.063-3.566l0.594 1.042c4.576 8.026 8.357 17.336 11.236 27.671l0.812 2.91a643.8 643.8 0 0 1-3.168-0.171l-2.111-0.118v19.169l2.109-0.115c10.789-0.59 19.378-0.876 26.258-0.876h14.698c-5.31 5.466-10.636 10.15-15.874 13.961l-1.13 0.821 0.382 1.343c0.981 3.452 1.537 7.614 1.657 12.395h-5.007c-9.928 0-19.346-0.294-27.991-0.874l-2.134-0.144v18.337l2.131-0.14c8.838-0.581 18.257-0.875 27.994-0.875h5.031v32.277l0.008 0.178c0.698 7.809-2.192 8.248-3.147 8.393-3.581 0.555-9.198 0.259-16.526-0.879l-3.658-0.567 1.53 3.371c2.814 6.197 4.53 13.068 5.101 20.421l0.15 1.941 1.944-0.099c12.078-0.608 20.516-2.107 25.803-4.583 5.717-2.701 8.616-9.224 8.616-19.387V242.15h9.426c6.822 0 14.762 0.294 23.6 0.875l2.131 0.14v-18.337l-2.134 0.144c-8.644 0.578-15.696 0.872-20.959 0.872z m-85.496-39.061c-1.549-10.316-3.469-19.693-5.738-28.02l-0.577-2.116-2.054 0.769c-3.63 1.358-6.796 2.336-9.604 2.963v-20.184h17.973v46.588z m-17.972-7.921c1.871 8.554 3.182 18.513 3.914 29.775l0.179 2.749 2.56-1.021c2.65-1.059 6.456-2.157 11.32-3.268v31.293c0 3.606-0.802 5.61-2.393 5.959-2.311 0.519-7.073 0.219-13.733-0.9l-1.847-0.31v-64.277zM329.28 262.121V153.548c3.514-8.188 6.328-14.515 8.6-19.336 2.263-4.818 6.036-10.763 11.215-17.668l1.73-2.307-2.768-0.813c-9.652-2.832-16.213-5.66-19.495-8.404l-2.166-1.811-0.989 2.644c-1.612 4.308-3.845 10.168-7.024 18.439-2.904 7.536-6.563 15.288-10.868 23.039-4.333 7.799-9.474 16.023-15.279 24.444-5.764 8.354-12.764 16.375-20.808 23.84l-1.858 1.724 2.109 1.406a69.278 69.278 0 0 1 13.668 11.959l1.544 1.761 1.497-1.8c3.091-3.715 6.497-7.861 10.123-12.323 2.933-3.61 6.309-8.098 10.07-13.383V263c0 17.881-0.295 32.035-0.876 42.072l-0.122 2.115h22.687l-0.112-2.105c-0.583-10.959-0.878-25.413-0.878-42.961z"
                        fill="#1afa29" p-id="2165"></path>
                    <path
                        d="M479.612 262.777c-7.771-1.104-14.221-3.897-19.166-8.302l-2.841-2.529-0.475 3.772c-1.158 9.2-2.46 16.021-3.867 20.271-1.222 3.654-3.594 5.597-7.459 6.104h-34.149c-4.046 0-9.427-1.25-9.427-12.063v-54.443a1248.092 1248.092 0 0 1 19.911-16.511c6.206-5.015 14.744-13.116 26.104-24.77 11.093-11.394 19.098-19.843 23.791-25.114l1.628-1.827-2.115-1.231c-6.86-3.992-12.636-8.321-17.168-12.867l-1.915-1.921-1.269 2.398c-5.148 9.732-12.438 19.641-21.662 29.447-8.341 8.866-17.513 17.613-27.306 26.045v-58.073c0-11.547 0.282-18.807 0.841-21.578l0.48-2.395h-24.009l0.242 2.218c0.575 5.257 0.867 11.394 0.867 18.239v78.149c-6.243 5.033-13.752 10.246-22.338 15.507-8.916 5.47-17.274 10.017-24.842 13.513l-2.793 1.29 2.313 2.029c4.51 3.955 8.517 8.823 11.909 14.468l1.041 1.732 1.721-1.06c7.706-4.742 14.677-9.191 20.714-13.222 4.61-3.066 8.723-6.033 12.272-8.854l0.003 47.7c0.779 19.02 12.031 23.012 21.334 23.012h49.219c7.483 0 13.54-1.936 18.002-5.756 4.487-3.854 8.438-13.989 12.079-30.981l0.449-2.098-2.119-0.299z"
                        fill="#1afa29" p-id="2166"></path>
                    <path
                        d="M324.1 351.098c-10.769 0-19.499 8.73-19.499 19.499v214.49c0 10.769 8.73 19.499 19.499 19.499s19.499-8.73 19.499-19.499v-214.49c0-10.769-8.73-19.499-19.499-19.499zM519.09 303.1c-10.769 0-19.498 8.73-19.498 19.499v154.49c0 10.769 8.729 19.499 19.498 19.499 10.77 0 19.5-8.73 19.5-19.499v-154.49c0-10.769-8.731-19.499-19.5-19.499zM729.079 216.104c-10.769 0-19.499 8.73-19.499 19.499v184.49c0 10.769 8.73 19.499 19.499 19.499 10.77 0 19.5-8.73 19.5-19.499v-184.49c0-10.769-8.73-19.499-19.5-19.499z"
                        fill="#1afa29" p-id="2167"></path>
                </svg>
                <div class="info-item-content">
                    <span class="info-item-value">0</span>
                    <span class="info-item-title">总基地数量</span>
                </div>
            </div>
            <div class="info-item days-operating">
                <svg t="1740537765454" class="info-item-ico clock-ico" viewBox="0 0 1024 1024" version="1.1"
                    xmlns="http://www.w3.org/2000/svg" p-id="24217" width="50" height="50">
                    <path
                        d="M951.446165 271.865236c-51.174633-4.949546-31.480395-50.566934-32.415931-47.760326A113.87955 113.87955 0 0 0 927.258155 183.908836a104.979961 104.979961 0 0 0-161.088148-87.700527 26.458884 26.458884 0 0 1-37.581371-8.395838C721.09635 81.231733 705.815925 48.775822 749.882081 31.984145a1.335338 1.335338 0 0 1 0.487758 0.047977A169.444006 169.444006 0 0 1 991.76218 183.908836a165.03819 165.03819 0 0 1-8.475798 51.88628c-1.479267 8.779648-4.269883 38.7328-31.840217 36.07012zM991.76218 543.730471a478.586763 478.586763 0 0 1-168.652398 365.067035l44.425978 67.062757a31.63232 31.63232 0 0 1-11.706197 43.378497 32.120078 32.120078 0 0 1-43.690343-11.626237l-40.228059-60.7219a479.322398 479.322398 0 0 1-522.668911-1.823096l-41.379488 62.928806a31.984145 31.984145 0 0 1-55.39654-31.984145l45.737328-69.565516A479.634244 479.634244 0 0 1 488.011891 64.575989V31.984145a31.984145 31.984145 0 0 1 63.968291 0v33.767262A479.706208 479.706208 0 0 1 991.76218 543.730471zM512 127.936581a415.79389 415.79389 0 1 0 415.79389 415.79389 415.79389 415.79389 0 0 0-415.79389-415.79389z m-218.747566-40.12411a26.123051 26.123051 0 0 1-37.285518 8.395838A103.948472 103.948472 0 0 0 96.20611 183.908836a114.735125 114.735125 0 0 0 8.163953 40.196074C103.402543 221.298302 122.960848 266.915689 72.218001 271.865236c-27.338448 2.66268-30.105077-27.290472-31.576347-36.07012A167.708866 167.708866 0 0 1 271.639148 32.032122 1.31135 1.31135 0 0 1 272.11891 31.984145c43.706335 16.791676 28.54585 49.247588 21.133524 55.828326z"
                        fill="#4cd392" p-id="24218"></path>
                    <path
                        d="M711.900908 591.706689H519.996036a31.984145 31.984145 0 0 1-31.984145-31.984145V271.865236a31.984145 31.984145 0 0 1 63.968291 0v255.873162h159.920726a31.984145 31.984145 0 0 1 0 63.968291z"
                        fill="#4cd392" p-id="24219"></path>
                </svg>
                <div class="info-item-content">
                    <span class="info-item-value">0</span>
                    <span class="info-item-title">运营天数</span>
                </div>
            </div>
            <div class="info-item">
                <svg t="1740537353098" class="info-item-ico eco-ico" viewBox="0 0 1142 1024" version="1.1"
                    xmlns="http://www.w3.org/2000/svg" p-id="17497" width="50" height="50">
                    <path
                        d="M1057.949538 494.276923l-26.781538 2.166154h-0.827077a10.121846 10.121846 0 0 1-10.161231-9.255385c-0.768-8.467692-1.752615-16.935385-3.012923-25.206154a10.279385 10.279385 0 0 1 8.467693-11.618461l26.505846-4.135385a10.948923 10.948923 0 0 1 7.876923 1.772308 10.673231 10.673231 0 0 1 4.076307 6.892308c1.437538 9.452308 2.599385 19.101538 3.426462 28.356923a10.180923 10.180923 0 0 1-9.570462 11.027692z m-11.638153-77.587692l-26.742154 6.498461a9.353846 9.353846 0 0 1-2.343385 0.196923 9.964308 9.964308 0 0 1-9.570461-7.286153A453.080615 453.080615 0 0 0 790.606769 137.255385a10.889846 10.889846 0 0 1-4.332307-4.923077L762.072615 70.892308l10.555077 4.52923a496.246154 496.246154 0 0 1 281.028923 328.861539 10.043077 10.043077 0 0 1-1.083077 7.68 10.633846 10.633846 0 0 1-6.262153 4.726154zM571.076923 377.501538a188.652308 188.652308 0 1 1 189.892923-188.652307A189.518769 189.518769 0 0 1 571.076923 377.501538z m11.126154-178.018461l-1.969231-7.876923a134.656 134.656 0 0 0-51.298461-74.633846 136.940308 136.940308 0 0 0-89.580308-14.966154l-8.132923 1.575384 1.969231 7.876924a134.656 134.656 0 0 0 51.298461 74.633846 122.249846 122.249846 0 0 0 65.299692 16.935384c5.907692 0 10.673231-0.196923 14.67077-0.590769v84.086154a8.861538 8.861538 0 0 0 17.723077 0v-87.04z m114.707692-78.572308a104.704 104.704 0 0 0-67.879384 11.421539 102.4 102.4 0 0 0-38.872616 56.516923l-1.496615 6.104615 6.163692 1.181539a131.524923 131.524923 0 0 0 18.392616 1.378461 94.050462 94.050462 0 0 0 49.486769-12.8 102.557538 102.557538 0 0 0 38.872615-56.516923l1.496616-6.104615z m-161.378461 291.643077a227.446154 227.446154 0 0 0 260.292923-188.061538 374.449231 374.449231 0 0 1 153.265231 269.390769 223.330462 223.330462 0 0 0-36.214154-3.150769 227.446154 227.446154 0 0 0-150.232616 55.926154 225.083077 225.083077 0 0 0-21.307077 319.015384 380.928 380.928 0 0 1-340.539077 0A225.851077 225.851077 0 0 0 193.063385 493.883077a374.370462 374.370462 0 0 1 153.26523-269.390769 227.032615 227.032615 0 0 0 189.302154 188.061538zM306.451692 165.612308a12.347077 12.347077 0 0 1-17.132307-2.56l-13.64677-18.116923a12.268308 12.268308 0 0 1 2.619077-17.329231c5.139692-3.741538 10.377846-7.286154 15.753846-10.830769a12.091077 12.091077 0 0 1 9.373539-1.969231 13.213538 13.213538 0 0 1 7.876923 5.513846l12.347077 18.904615a12.248615 12.248615 0 0 1-3.505231 16.935385c-4.608 2.953846-9.176615 6.301538-13.686154 9.452308zM121.088 500.775385a48.029538 48.029538 0 0 1-19.692308 36.430769l-27.687384 19.889231-0.531693-11.027693c-0.295385-5.907692-0.590769-11.815385-0.590769-17.723077a495.852308 495.852308 0 0 1 160.433231-363.913846 13.252923 13.252923 0 0 1 9.964308-3.544615 13.784615 13.784615 0 0 1 9.609846 4.529231l13.430154 15.163077a13.193846 13.193846 0 0 1-0.964923 18.707692 445.538462 445.538462 0 0 0-143.970462 301.489231z m108.189538 27.56923A188.750769 188.750769 0 1 1 39.384615 717.193846a189.696 189.696 0 0 1 189.892923-188.849231z m30.680616 203.027693a130.697846 130.697846 0 0 0 18.372923 1.378461 94.011077 94.011077 0 0 0 49.486769-12.8 102.518154 102.518154 0 0 0 38.892308-56.516923l1.476923-6.104615-6.144-1.181539a104.684308 104.684308 0 0 0-67.879385 11.421539 102.518154 102.518154 0 0 0-38.892307 56.516923l-1.476923 6.104615z m-161.634462-84.676923a134.774154 134.774154 0 0 0 51.2 74.633846 122.308923 122.308923 0 0 0 65.319385 16.935384c5.907692 0 10.673231-0.196923 14.670769-0.590769v84.086154a8.861538 8.861538 0 0 0 17.723077 0v-87.04l-1.969231-7.876923a134.734769 134.734769 0 0 0-51.318154-74.633846 136.881231 136.881231 0 0 0-89.560615-14.966154l-8.132923 1.575385zM362.929231 937.944615a10.791385 10.791385 0 0 1 14.296615-4.726153c8.211692 3.938462 16.600615 7.483077 24.930462 10.830769a10.614154 10.614154 0 0 1 5.907692 13.784615l-9.314462 23.827692a11.401846 11.401846 0 0 1-10.220307 7.089231 14.257231 14.257231 0 0 1-4.036923-0.787692c-9.314462-3.741538-18.747077-7.876923-28.041846-12.406154a10.377846 10.377846 0 0 1-5.592616-6.104615 11.047385 11.047385 0 0 1 0.531692-8.467693z m74.259692 30.523077a11.559385 11.559385 0 0 1 14.099692-7.876923 455.010462 455.010462 0 0 0 119.788308 15.950769h0.807385a450.697846 450.697846 0 0 0 228.135384-62.030769 12.130462 12.130462 0 0 1 10.732308-0.787692l47.517538 19.298461-7.286153 4.923077a495.320615 495.320615 0 0 1-279.256616 85.858462H571.076923a513.969231 513.969231 0 0 1-131.938461-17.526154 12.583385 12.583385 0 0 1-7.50277-5.907692 12.248615 12.248615 0 0 1-1.102769-9.452308z m285.794462-251.273846A189.892923 189.892923 0 1 1 912.876308 905.846154a189.321846 189.321846 0 0 1-189.892923-188.652308z m217.580307 13.587692a103.168 103.168 0 0 0 18.372923 1.378462 94.050462 94.050462 0 0 0 49.48677-12.8 102.4 102.4 0 0 0 38.872615-56.516923l1.496615-6.104615-6.144-1.181539a104.684308 104.684308 0 0 0-67.879384 11.421539 102.203077 102.203077 0 0 0-38.872616 56.516923l-1.516307 6.104615z m-110.276923-10.043076a122.289231 122.289231 0 0 0 65.299693 16.935384c5.907692 0 10.692923-0.196923 14.670769-0.590769v84.086154a8.881231 8.881231 0 0 0 17.723077 0v-87.04l-1.969231-7.876923a134.439385 134.439385 0 0 0-51.2-74.436923 136.231385 136.231385 0 0 0-89.580308-15.163077l-8.132923 1.575384 1.969231 8.073846a135.069538 135.069538 0 0 0 51.160615 74.436924z"
                        fill="#44BE62" p-id="17498"></path>
                </svg>
                <div class="info-item-content">
                    <span class="info-item-value">98.7%</span>
                    <span class="info-item-title">资源循环率</span>
                </div>
            </div>
        </div>
        <div ref="chartDom" class="chart-container"></div>
    </div>
</template>

<style scoped>
.chart-container {
    width: 100%;
    height: 860px;
}

.panel-title .icon {
    margin-right: 10px;
    filter: drop-shadow(0 0 5px #1afa29);
}
.base-info {
    height: 160px;
    /* 改为固定高度更好控制 */
    display: flex;
    justify-content: space-between;
    padding: 20px;
    margin: 20px 0;
    background: linear-gradient(145deg, rgba(26, 250, 41, 0.1) 0%, rgba(0, 15, 64, 0.8) 100%);
    border-radius: 16px;
    backdrop-filter: blur(8px);
    border: 1px solid rgba(26, 250, 41, 0.3);
    box-shadow: 0 8px 32px rgba(0, 45, 120, 0.3);
}

.info-item {
    flex: 1;
    display: flex;
    align-items: center;
    margin: 0 15px;
    padding: 20px;
    background: linear-gradient(135deg,
            rgba(26, 250, 41, 0.15) 0%,
            rgba(0, 28, 61, 0.5) 100%);
    border-radius: 12px;
    transition: all 0.3s ease;
    cursor: pointer;
    position: relative;
    overflow: hidden;
}

.info-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 24px rgba(26, 250, 41, 0.2);
    background: linear-gradient(135deg,
            rgba(26, 250, 41, 0.25) 0%,
            rgba(0, 28, 61, 0.6) 100%);
}

.info-item::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: linear-gradient(45deg,
            transparent 25%,
            rgba(26, 250, 41, 0.1) 50%,
            transparent 75%);
    animation: flow 8s infinite linear;
}

@keyframes flow {
    0% {
        transform: translate(-50%, -50%) rotate(0deg);
    }

    100% {
        transform: translate(-50%, -50%) rotate(360deg);
    }
}
.info-item-ico {
    width: 60px;
    height: 60px;
    margin-right: 20px;
    filter: drop-shadow(0 0 12px #1afa29);
    transition: transform 0.3s ease;
}

.info-item:hover .info-item-ico {
    transform: scale(1.1) rotate(10deg);
}

.info-item-content {
    display: flex;
    flex-direction: column;
    position: relative;
    z-index: 1;
}

.info-item-value {
    font-size: 32px;
    font-weight: 700;
    background: linear-gradient(45deg, #1afa29 30%, #00ff88 70%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    text-shadow: 0 4px 16px rgba(26, 250, 41, 0.3);
    margin-bottom: 8px;
    font-family: 'Arial Rounded MT Bold', sans-serif;
}

.info-item-title {
    font-size: 18px;
    color: rgba(255, 255, 255, 0.9);
    letter-spacing: 1px;
    position: relative;
    padding-left: 24px;
}

.info-item-title::before {
    content: '';
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
    width: 16px;
    height: 2px;
    background: #1afa29;
    box-shadow: 0 0 8px #1afa29;
}
.eco-ico {
    filter: drop-shadow(0 0 10px #00ff88);
}

.info-item:nth-child(3) {
    background: linear-gradient(45deg,
            rgba(0, 255, 136, 0.1) 0%,
            rgba(0, 72, 114, 0.6) 100%);
}


.days-operating {
    background: linear-gradient(45deg,
            rgba(0, 168, 255, 0.15) 0%,
            rgba(0, 42, 85, 0.6) 100%);
    border: 1px solid rgba(0, 198, 255, 0.3);
}

.clock-ico {
    filter: drop-shadow(0 0 15px #00a8ff);
}

.days-operating::after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 50%;
    height: 100%;
    background: linear-gradient(90deg,
            transparent,
            rgba(0, 198, 255, 0.2),
            transparent);
    animation: timeFlow 3s infinite;
}

@keyframes timeFlow {
    0% {
        left: -100%;
    }

    100% {
        left: 150%;
    }
}


.days-operating .info-item-title::before {
    background: #00a8ff;
    box-shadow: 0 0 8px #00a8ff;
}

</style>