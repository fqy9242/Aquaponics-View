<template>
    <section class="panel-box water-quality-panel">
        <div style="display: flex; flex-direction: column; align-items: center;justify-content: center;" >
       <svg t="1739709683698" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1510" width="30" height="30"><path d="M810.946385 398.138063V127.312332L763.491287 0H399.541305l-45.158883 127.567467v345.069997h76.54048v115.065854h0.127568v121.444229c19.262687 4.847564 37.75997 13.394584 54.34374 25.896195l28.957815 21.941605v-43.500507h83.811826c42.862669-15.308096 91.338306-10.715667 130.88422 14.032422V587.703318h78.198857v151.550151l5.485401-4.209727c23.089711-17.476743 50.134014-27.427005 77.816155-29.850787v-117.489637h109.197751V398.138063h-188.79985zM453.629911 76.54048h256.79331l19.517823 52.302661H435.005061L453.629911 76.54048z m-22.834576 319.684071V203.980379h303.61057v192.244172H641.664357v-104.73289h-113.79018v104.73289h-97.078842z m214.951181 284.347883h-131.394491v-30.871327h131.394491v30.871327z m0-63.783733h-131.394491v-29.085383h131.394491v29.085383z m277.459239-105.625862H507.463382V474.550976h415.742373v36.611863zM776.375601 1023.984054a112.004236 112.004236 0 0 1-67.865892-22.707009l-37.887537-28.70268c-12.756747-9.695127-30.488625-9.56756-43.117804 0l-37.887538 28.70268c-39.928617 30.23349-95.6756 30.361057-135.604217 0l-37.887537-28.70268c-12.756747-9.695127-30.488625-9.56756-43.117804 0l-37.887537 28.70268c-39.928617 30.23349-95.6756 30.361057-135.604217 0l-37.887538-28.70268c-12.756747-9.56756-30.488625-9.56756-43.117804 0l-49.496177 37.504835a38.244726 38.244726 0 1 1-46.179422-60.977249l49.496177-37.504835c39.928617-30.23349 95.803167-30.23349 135.604216 0l37.887538 28.70268c12.756747 9.56756 30.488625 9.56756 43.117804 0l37.887537-28.70268c39.928617-30.23349 95.6756-30.361057 135.604217 0l37.887538 28.70268c12.756747 9.56756 30.488625 9.56756 43.117804 0l37.887537-28.70268c39.928617-30.23349 95.6756-30.361057 135.604217 0l37.887538 28.70268c12.756747 9.56756 30.488625 9.56756 43.117803 0l37.887538-28.70268c39.928617-30.23349 95.6756-30.361057 135.604217 0l37.887537 28.70268a38.244726 38.244726 0 1 1-46.179422 60.977249l-37.887538-28.70268c-12.756747-9.56756-30.488625-9.56756-43.117804 0l-37.887537 28.70268a112.259371 112.259371 0 0 1-67.865893 22.707009z" p-id="1511" fill="#1afa29"></path><path d="M776.375601 878.046872a112.004236 112.004236 0 0 1-67.865892-22.707009l-37.887537-28.70268c-12.756747-9.695127-30.488625-9.56756-43.117804 0l-37.887538 28.70268c-39.928617 30.23349-95.6756 30.361057-135.604217 0l-37.887537-28.70268c-12.756747-9.695127-30.488625-9.56756-43.117804 0l-37.887537 28.70268c-39.928617 30.23349-95.6756 30.361057-135.604217 0l-37.887538-28.70268c-12.756747-9.56756-30.488625-9.56756-43.117804 0l-49.496177 37.504835a38.244726 38.244726 0 1 1-46.179422-60.977249l49.496177-37.504835c39.928617-30.23349 95.6756-30.361057 135.604216 0l37.887538 28.70268c12.756747 9.56756 30.488625 9.56756 43.117804 0l37.887537-28.70268c39.928617-30.23349 95.6756-30.361057 135.604217 0l37.887538 28.70268c12.756747 9.56756 30.488625 9.56756 43.117804 0l37.887537-28.70268c39.928617-30.23349 95.6756-30.361057 135.604217 0l37.887538 28.70268c12.756747 9.56756 30.488625 9.56756 43.117803 0l37.887538-28.70268c39.928617-30.23349 95.6756-30.361057 135.604217 0l37.887537 28.70268a38.244726 38.244726 0 1 1-46.179422 60.977249l-37.887538-28.70268c-12.756747-9.56756-30.488625-9.56756-43.117804 0l-37.887537 28.70268a112.259371 112.259371 0 0 1-67.865893 22.707009z" p-id="1512" fill="#1afa29"></path><path d="M179.870128 741.294548C80.622639 741.294548 0 660.671909 0 561.42442c0-17.221608 0-69.651837 86.10804-210.231185l93.762088-153.208527 93.762088 153.208527c86.10804 140.706916 86.10804 193.137144 86.10804 210.231185 0 99.247489-80.750206 179.870128-179.870128 179.870128z m0-396.607253l-28.447545 46.434557C83.811826 501.467711 76.54048 547.009297 76.54048 561.42442c0 56.89509 46.30699 103.329648 103.329648 103.329648s103.329648-46.30699 103.329648-103.329648c0-14.415124-7.271346-59.956709-74.882103-170.302568l-28.447545-46.434557z" p-id="1513" fill="#1afa29"></path><path d="M220.436582 592.16818m-28.319977 0a28.319978 28.319978 0 1 0 56.639955 0 28.319978 28.319978 0 1 0-56.639955 0Z" p-id="1514" fill="#1afa29"></path><path d="M138.538269 563.97577m-28.319978 0a28.319978 28.319978 0 1 0 56.639955 0 28.319978 28.319978 0 1 0-56.639955 0Z" p-id="1515" fill="#1afa29"></path><path d="M192.116605 494.834203m-28.319978 0a28.319978 28.319978 0 1 0 56.639955 0 28.319978 28.319978 0 1 0-56.639955 0Z" p-id="1516" fill="#1afa29"></path></svg>
            <h2 class="panel-title">水质监测站</h2>
        </div>
        <div class="data-grid">
            <div class="data-item" v-for="(item, index) in waterData" :key="item.label">
                <div class="chart-background">
                    <svg class="mini-chart" viewBox="0 0 100 30">
                        <path
                            fill="none"
                            :stroke="chartColors[item.colorIndex % chartColors.length]"
                            stroke-width="1"
                            :d="generateChartPath(item.history, item.colorIndex).pathD"
                        />
                        <circle
                            v-for="(point, pointIndex) in generateChartPath(item.history, item.colorIndex).points"
                            :key="pointIndex"
                            :cx="point.x"
                            :cy="point.y"
                            r="2"
                            :fill="chartColors[item.colorIndex % chartColors.length]"
                        />
                        <text
                            v-for="(point, pointIndex) in generateChartPath(item.history, item.colorIndex).points"
                            :key="`text-${pointIndex}`"
                            :x="point.x"
                            :y="point.y - 5"
                            class="data-point-label"
                            text-anchor="middle"
                            >{{ item.history[pointIndex] }}</text> <!-- 显示原始数值 -->
                    </svg>
                </div>
                <div class="data-sxs">
                    <svg v-html="item.icon" class="icon" width="30" height="30"></svg>
                    <span class="data-label">{{ item.label }}</span>
                </div>
                <div class="data-info">
                    <span class="data-value">{{ item.value }}</span>
                    <span class="data-unit">{{ item.unit }}</span>
                </div>
            </div>
        </div>
    </section>
</template>

<script setup>
import { ref, computed } from 'vue';

const chartColors = ['#ff6f61', '#88d8b0', '#ffa07a', '#abdee6', '#cbaacb', '#a8d077', '#fdd47e', '#b2bec3', '#6c5ce7', '#ffcccc'];

const waterData = ref([
    {
        label: '酸碱度',
        value: '7',
        unit: '',
        icon: `<svg t="1739689991691" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5639" width="30" height="30"><path d="M616.682 255.271V420.78c15.274-32.987 44.027-52.078 74.121-49.204 21.058-1.653 41.727 7.726 57.178 25.942 15.031 23.479 22.27 53.496 20.115 83.644v284.933h-77.998V500.396c1.189-14.723-1.545-29.526-7.767-42.042-6.677-8.5-15.994-12.765-25.413-11.633-12.705-0.517-24.881 6.465-32.959 18.895-8.085 12.435-11.165 28.919-8.332 44.624v255.855h-78.354V255.271h79.409z m-226.59 0c17.994-0.662 35.869 3.931 52.235 13.419 13.765 7.917 25.87 19.908 35.296 34.892 8.821 14.584 15.213 31.355 18.705 49.204a280.115 280.115 0 0 1 5.647 55.469c0.464 23.492-2.653 46.884-9.176 68.882-5.611 18.34-14.541 34.754-26.12 47.857-11.682 12.8-25.408 22.239-40.234 27.738-17.052 6.484-34.785 9.653-52.59 9.393h-44.824v203.97h-81.176V255.271h142.237z m-24.709 231.257c14.548 0.717 28.663-6.034 39.18-18.783 10.944-16.061 16.308-37.043 14.821-58.153 1.201-20.864-3.425-41.606-13.056-58.596-11.303-14.728-27.281-22.134-43.411-20.126h-35.298v155.215h35.298l2.466 0.443z m0 0" fill="#1afa29" p-id="5640"></path></svg>`,
        history: [7.2, 7.1, 6.9, 7.0, 7.3, 7.1, 7.0],
        colorIndex: 0,
    },
    {
        label: '氨氮',
        value: '58',
        unit: '%',
        icon: `<svg t="1739692347481" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7563" width="30" height="30"><path d="M800 667.84h-64a32 32 0 0 1 0-64h64a32 32 0 0 1 0 64z m-192 0H224a32 32 0 0 1 0-64h384a32 32 0 0 1 0 64z m128 128h-256a32 32 0 0 1 0-64h256a32 32 0 0 1 0 64z m-384 0H288a32 32 0 0 1 0-64h64a32 32 0 0 1 0 64z m160-256a32 32 0 0 1-32-32V352a64 64 0 1 0-128 0v155.84a32 32 0 1 1-64 0V352a128 128 0 1 1 256 0v155.84a32 32 0 0 1-32 32z m88.96 0c0-9.472 1.056-18.912 3.2-28.16a101.44 101.44 0 0 1 9.28-24.96 134.4 134.4 0 0 1 15.68-23.04 244.8 244.8 0 0 1 22.08-23.04l18.56-17.28a102.4 102.4 0 0 0 12.16-12.48c2.848-3.52 5.216-7.36 7.04-11.52a42.56 42.56 0 0 0 3.52-12.48c0.32-5.12 0.32-10.24 0-15.36a22.72 22.72 0 0 0-22.4-28.16 20.8 20.8 0 0 0-21.44 13.12 45.44 45.44 0 0 0-3.52 14.08v16.96h-44.16v-7.68a65.92 65.92 0 0 1 16.96-48.64 72.96 72.96 0 0 1 53.44-16.96 71.68 71.68 0 0 1 51.2 16 60.8 60.8 0 0 1 16.64 45.76 101.76 101.76 0 0 1-1.92 20.16 76.16 76.16 0 0 1-6.08 17.92 84.48 84.48 0 0 1-10.88 16.96 163.52 163.52 0 0 1-16.32 16.64l-25.6 23.68a96 96 0 0 0-16 17.92 53.12 53.12 0 0 0-7.36 15.36h85.44v35.2h-139.52z" fill="#1afa29   " p-id="7564"></path></svg>`,
        history: [55, 56, 57, 59, 60, 58, 57],
        colorIndex: 1,
    },
    {
        label: '总磷',
        value: '58',
        unit: '%',
        icon: `<svg t="1739692775553" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11517" id="mx_n_1739692775554" width="30" height="30"><path d="M726.779661 259.297627C680.265763 191.869831 633.491525 131.297627 602.771525 92.420339c-35.406102-44.517966-59.877966-72.981695-63.262372-76.8a37.575593 37.575593 0 0 0-61.266441 0.433898c-3.297627 3.731525-27.422373 32.542373-62.221017 77.494238-30.459661 39.311186-76.279322 100.490847-121.491526 168.439322A1662.524746 1662.524746 0 0 0 175.294915 464.618305C139.802034 538.467797 122.012203 598.779661 122.272542 644.772881c1.562034 205.667797 175.902373 372.545085 392.938305 379.227119 216.949153-9.372203 389.12-178.158644 388.078645-384.08678 0-45.732881-18.831186-106.131525-55.191865-179.460339a1670.595254 1670.595254 0 0 0-121.317966-201.155254zM514.690169 937.220339c-170.435254-6.768814-304.423051-134.942373-305.637966-292.881356 0-18.223729 5.553898-60.745763 44.431187-142.058305a1587.11322 1587.11322 0 0 1 112.813559-191.869831c44.170847-65.778983 88.862373-125.309831 118.541017-163.66644 8.677966-11.715254 17.355932-22.389153 24.818983-31.674576 7.549831 9.198644 16.054237 19.698983 25.339661 31.414237C564.935593 184.32 610.321356 242.983051 655.36 308.501695a1596.225085 1596.225085 0 0 1 114.983051 190.394576c39.918644 80.618305 46.08 123.313898 46.16678 141.450848C817.377627 798.372881 685.038644 928.542373 514.690169 937.220339z" p-id="11518" fill="#1afa29"></path><path d="M419.92678 459.932203l104.135593-0.694237c65.431864 0 119.495593 22.475932 119.929491 95.457627 0 70.638644-54.063729 102.139661-116.718644 102.57356h-34.711864l0.607458 98.581694-71.506441 0.433899z m103.441356 141.450848c34.711864 0 51.460339-16.661695 51.286779-45.819661S555.389831 515.037288 520.677966 515.210847h-29.157966l0.607458 85.825085zM79.490169 156.20339h51.2c32.195254 0 58.749831 11.021017 58.92339 47.121356s-26.554576 50.245424-57.361356 50.418983h-17.355932v48.50983H79.750508zM130.169492 225.627119c17.355932 0 25.252881-8.157288 25.166101-22.475933s-9.545763-19.785763-26.033898-19.698983h-14.578983v42.261695zM812.778305 68.382373h68.208814c43.389831 0 78.101695 14.665763 78.622373 62.741695 0 46.340339-35.406102 66.907119-76.452882 67.167457h-22.736271v64.564068h-46.774237z m67.774915 92.680678c22.736271 0 33.670508-11.021017 33.583729-30.025763s-12.75661-26.033898-35.232542-26.033898h-19.091526v56.23322z" p-id="11519" fill="#1afa29"></path></svg>`,
        history: [56, 57, 58, 59, 60, 59, 58],
        colorIndex: 2,
    },
    {
        label: '总氮',
        value: '58',
        unit: '%',
        icon: `<svg t="1739692644222" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="10298" width="30" height="30"><path d="M190.915254 182.237288a95.457627 95.457627 0 1 0-95.457627 95.457627 95.457627 95.457627 0 0 0 95.457627-95.457627zM52.067797 182.237288a43.389831 43.389831 0 1 1 43.38983 43.389831 43.389831 43.389831 0 0 1-43.38983-43.389831z" p-id="10299" fill="#1afa29"></path><path d="M321.084746 60.745763m-60.745763 0a60.745763 60.745763 0 1 0 121.491525 0 60.745763 60.745763 0 1 0-121.491525 0Z" p-id="10300" fill="#1afa29"></path><path d="M937.220339 676.881356a86.779661 86.779661 0 1 0 86.779661 86.779661 86.779661 86.779661 0 0 0-86.779661-86.779661z m0 121.491525a34.711864 34.711864 0 1 1 34.711864-34.711864 34.711864 34.711864 0 0 1-34.711864 34.711864zM407.864407 295.050847a364.474576 364.474576 0 1 0 364.474576 364.474577 364.474576 364.474576 0 0 0-364.474576-364.474577z m0 659.525424a295.050847 295.050847 0 1 1 295.050847-295.050847 295.050847 295.050847 0 0 1-295.050847 295.050847z" p-id="10301" fill="#1afa29"></path><path d="M937.220339 364.474576a242.983051 242.983051 0 0 0-456.981695-115.06983 405.868475 405.868475 0 0 1 69.423729 18.657627 173.99322 173.99322 0 0 1 55.278644-52.067797l4.252203-2.343051c1.301695-0.694237 2.51661-1.475254 3.818305-2.082711 4.165424-2.256271 8.677966-4.338983 12.84339-6.248136l3.210848-1.214915c3.644746-1.475254 7.202712-2.776949 10.934237-3.991865l4.772881-1.562034c4.512542-1.301695 8.677966-2.51661 13.884746-3.557966h2.256271q6.508475-1.301695 13.277288-2.082712l4.338983-0.433898c5.20678-1.562034 10.413559-1.562034 15.707119-1.562034a173.559322 173.559322 0 0 1 173.559322 173.559322c0 5.20678 0 10.32678-0.781017 15.44678v4.338983c-0.520678 4.599322-1.214915 8.677966-2.082712 13.624407 0 2.082712-0.867797 3.991864-1.388474 6.074576s-1.214915 4.946441-1.909153 7.463051-1.388475 5.03322-2.256271 7.463051l-0.520678 1.475254a170.174915 170.174915 0 0 1-7.029152 17.355932c-0.520678 1.041356-0.954576 2.082712-1.475255 3.037288a174.340339 174.340339 0 0 1-54.931525 64.824407 421.662373 421.662373 0 0 1 20.827119 69.423729A242.983051 242.983051 0 0 0 937.220339 364.474576zM270.926102 597.564746h-59.270509v-43.389831h171.65017v43.389831h-59.530848v175.815593h-52.848813zM417.32339 553.914576h53.62983l54.584407 105.00339L546.711864 707.601356h1.475255a694.237288 694.237288 0 0 1-7.029153-81.138983v-72.547797h50.158644v219.465763H538.033898l-54.237288-105.871186-21.608135-48.162712h-1.475255c2.429831 24.558644 6.855593 54.584407 6.855594 81.138983v72.894915h-50.245424z" p-id="10302" fill="#1afa29"></path></svg>`,
        history: [60, 59, 58, 57, 56, 57, 58],
        colorIndex: 3,
    },
    {
        label: '水温',
        value: '25',
        unit: '℃',
        icon: `<svg t="1739692613353" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8890" width="30" height="30"><path d="M819.368421 1023.993578a169.306057 169.306057 0 0 1-104.13494-34.711646l-15.099567-11.628402a78.101205 78.101205 0 0 0-89.295711 0L607.453818 980.60402a176.074828 176.074828 0 0 1-208.269881 0 78.101205 78.101205 0 0 0-89.295711 0l-4.338956 3.297606a169.219278 169.219278 0 0 1-104.13494 34.190972 169.219278 169.219278 0 0 1-104.13494-34.190972l-19.091406-14.926008a46.947502 46.947502 0 0 1-7.549783-66.472803 47.988852 47.988852 0 0 1 37.748916-18.050056 46.860723 46.860723 0 0 1 29.591679 10.153156l19.091405 15.012787a74.109366 74.109366 0 0 0 44.604466 13.884659 74.196145 74.196145 0 0 0 44.691246-13.884659l4.252176-3.471164a170.260627 170.260627 0 0 1 104.134941-34.190972 170.173848 170.173848 0 0 1 104.13494 34.190972 78.101205 78.101205 0 0 0 89.38249 0l3.124048-2.516595a175.640932 175.640932 0 0 1 208.269881 0l15.012787 11.715181a78.708659 78.708659 0 0 0 89.295711 0l23.256803-18.223614a48.509526 48.509526 0 0 1 65.952129 8.677911 47.034281 47.034281 0 0 1-6.421655 65.518233l-23.343582 18.050057A169.219278 169.219278 0 0 1 819.368421 1023.993578z m45.819374-253.4818a176.508724 176.508724 0 0 1-111.511166-38.703486 263.461399 263.461399 0 0 0 26.033736-103.614265 164.880322 164.880322 0 0 1 15.533461 12.409413l17.355824 15.7938a81.138474 81.138474 0 0 0 105.783743 0l26.988306-24.298153a48.335968 48.335968 0 0 1 66.386024 4.078618 46.947502 46.947502 0 0 1-1.475245 65.691792l-26.814747 24.298152a173.558234 173.558234 0 0 1-118.279936 44.344129z m-709.766397-7.983679a174.512804 174.512804 0 0 1-118.019599-44.344128l-21.955116-19.959197a47.20784 47.20784 0 0 1-2.776932-66.993478 48.422747 48.422747 0 0 1 67.861269-2.690153l21.955117 19.959197a78.101205 78.101205 0 0 0 52.935261 19.698859A78.101205 78.101205 0 0 0 208.26988 648.50034l5.033189-4.686072a160.107471 160.107471 0 0 1 30.980145-22.215454 265.977993 265.977993 0 0 0 22.302233 102.225799 176.595503 176.595503 0 0 1-111.337607 38.703486z" p-id="8891" fill="#1afa29"></path><path d="M807.045786 43.389558v69.423294H668.199199V43.389558zM807.045786 182.236145v69.423294H668.199199v-69.423294zM807.045786 321.082732v69.423294H668.199199v-69.423294z" p-id="8892" fill="#1afa29"></path><path d="M624.809641 454.288676V112.812852A112.812852 112.812852 0 0 0 511.996789 0a112.812852 112.812852 0 0 0-112.812852 112.812852v341.475824a197.856386 197.856386 0 1 0 226.0596 0zM511.996789 720.26667a104.13494 104.13494 0 0 1-34.711647-202.195343V251.659439h69.423294v266.411888A104.13494 104.13494 0 0 1 511.996789 720.26667z" p-id="8893" fill="#1afa29"></path></svg>`,
        history: [24, 24.5, 25, 25.5, 26, 25.8, 25.5],
        colorIndex: 4,
    }
]);


const generateChartPath = (historyData, colorIndex) => {
    if (!historyData || historyData.length < 2) return { pathD: '', points: [] };

    const minValue = Math.min(...historyData);
    const maxValue = Math.max(...historyData);
    const dataRange = maxValue - minValue;

    const pointsData = historyData.map((value, index) => {
        const x = (index / (historyData.length - 1)) * 90;
        let y;
        if (dataRange === 0) {
            y = 15;
        } else {
            const normalizedValue = (value - minValue) / dataRange;
            y = 30 - (normalizedValue * 30);
        }
        return { x, y }; // 返回点的 x, y 坐标
    });

    const pathD = `M ${pointsData.map(p => `${p.x} ${p.y}`).join(' L ')}`;

    return { pathD, points: pointsData }; // 返回路径数据和点数据
};


</script>

<style scoped>




.icon {
    fill: #1afa29;
}
.chart-background {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0.4; /* 调整图表背景的透明度 */
    z-index: -1; /* 将图表置于内容下方 */
}

.mini-chart {
    width: 100%;
    height: 100%;
}


.data-point-label {
    font-size: 0.3rem; /* 更小的字体 */
    fill: #ffffff; /* 柔和的文本颜色，与 data-value 颜色一致 */
    opacity: 1; /* 稍微降低透明度，使其不那么突出 */
    /* text-shadow: 0 0 1px rgba(0, 0, 0, 0.5);  可以添加可选的文字阴影 */
    /* pointer-events: none;  防止文本标签干扰鼠标事件（如果需要） */
}

</style>